# PIDtest.db
#
# This file provides the PVs necessary for the EPICS Sequencer module demo
# Specifically, the demo shows how Sequencer can be used as a PID controller
#
# Author(s): Ryan Yang (ryang2@mit.edu)
#
# Changlog:
# 2021/05/23 - Documentation
# 2021/05/17 - Added PIDtest.db

record(bo, "pid:onOff") {
    field(VAL, 0)
    field(DTYP, "Soft Channel")
    field(ZNAM, "Off")
    field(ONAM, "On")
}

record(ao, "pid:sampleTime") {
    field(VAL, 1)
}

record(ao, "pid:setpoint") {
    field(VAL, 5)
}

record(ao, "pid:Kp") {
    field(VAL, 1)
}

record(ao, "pid:Ki") {
    field(VAL, 0.5)
}


record(ao, "pid:Kd") {
    field(VAL, 0.5)
}

record(ao, "pid:bias") {
    field(VAL, 0)
}

record(ai, "pid:readback") {
    field(SCAN, "Passive")
    field(INP, "pid:calcReadback.VAL  NPP NMS")
}

record(calc, "pid:calcReadback") { 
    field(SCAN, "1 second")
    field(INPA, "pid:readback.VAL  NPP NMS")
    field(CALC, "(A<9)?(A+1):0")
    field(FLNK, "pid:readback.PROC PP")
}

record(ao, "pid:output") {
    field(VAL, 0)
}

